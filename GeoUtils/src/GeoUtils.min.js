var BMapGLLib=window.BMapGLLib=BMapGLLib||{};(function(){var t=6370996.81;var a=BMapGLLib.GeoUtils=function(){};a.isPointInRect=function(t,a){if(!(t.toString()==="Point"||t.toString()==="LatLng")||!(a instanceof BMapGL.Bounds)){return false}var n=a.getSouthWest();var r=a.getNorthEast();return t.lng>=n.lng&&t.lng<=r.lng&&t.lat>=n.lat&&t.lat<=r.lat};a.isPointInCircle=function(t,n){if(!(t.toString()==="Point"||t.toString()==="LatLng")||!(n instanceof BMapGL.Circle)){return false}var r=n.getCenter();var l=n.getRadius();var e=a.getDistance(t,r);if(e<=l){return true}else{return false}};a.isPointOnPolyline=function(t,a){if(!(t.toString()==="Point"||t.toString()==="LatLng")||!(a instanceof BMapGL.Polyline)){return false}var n=a.getBounds();if(!this.isPointInRect(t,n)){return false}var r=a.getPath();for(var l=0;l<r.length-1;l++){var e=r[l];var i=r[l+1];if(t.lng>=Math.min(e.lng,i.lng)&&t.lng<=Math.max(e.lng,i.lng)&&t.lat>=Math.min(e.lat,i.lat)&&t.lat<=Math.max(e.lat,i.lat)){var o=(e.lng-t.lng)*(i.lat-t.lat)-(i.lng-t.lng)*(e.lat-t.lat);if(o<2e-9&&o>-2e-9){return true}}}return false};a.isPointInPolygon=function(t,a){if(!(t.toString()==="Point"||t.toString()==="LatLng")||!(a instanceof BMapGL.Polygon)){return false}var n=a.getBounds();if(!this.isPointInRect(t,n)){return false}var r=a.getPath();var l=r.length;var e=true;var i=0;var o=2e-10;var g,h;var f=t;g=r[0];for(var s=1;s<=l;++s){if(f.equals(g)){return e}h=r[s%l];if(f.lat<Math.min(g.lat,h.lat)||f.lat>Math.max(g.lat,h.lat)){g=h;continue}if(f.lat>Math.min(g.lat,h.lat)&&f.lat<Math.max(g.lat,h.lat)){if(f.lng<=Math.max(g.lng,h.lng)){if(g.lat==h.lat&&f.lng>=Math.min(g.lng,h.lng)){return e}if(g.lng==h.lng){if(g.lng==f.lng){return e}else{++i}}else{var M=(f.lat-g.lat)*(h.lng-g.lng)/(h.lat-g.lat)+g.lng;if(Math.abs(f.lng-M)<o){return e}if(f.lng<M){++i}}}}else{if(f.lat==h.lat&&f.lng<=h.lng){var v=r[(s+1)%l];if(f.lat>=Math.min(g.lat,v.lat)&&f.lat<=Math.max(g.lat,v.lat)){++i}else{i+=2}}}g=h}if(i%2==0){return false}else{return true}};a.degreeToRad=function(t){return Math.PI*t/180};a.radToDegree=function(t){return 180*t/Math.PI};function n(t,a,n){if(a!=null){t=Math.max(t,a)}if(n!=null){t=Math.min(t,n)}return t}function r(t,a,n){while(t>n){t-=n-a}while(t<a){t+=n-a}return t}a.getDistance=function(l,e){if(!(l.toString()==="Point"||l.toString()==="LatLng"||e.toString()==="Point"||e.toString()==="LatLng")){return 0}l.lng=r(l.lng,-180,180);l.lat=n(l.lat,-74,74);e.lng=r(e.lng,-180,180);e.lat=n(e.lat,-74,74);var i,o,g,h;i=a.degreeToRad(l.lng);g=a.degreeToRad(l.lat);o=a.degreeToRad(e.lng);h=a.degreeToRad(e.lat);return t*Math.acos(Math.sin(g)*Math.sin(h)+Math.cos(g)*Math.cos(h)*Math.cos(o-i))};a.getPolylineDistance=function(t){if(t instanceof BMapGL.Polyline||t instanceof Array){var n;if(t instanceof BMapGL.Polyline){n=t.getPath()}else{n=t}if(n.length<2){return 0}var r=0;for(var l=0;l<n.length-1;l++){var e=n[l];var i=n[l+1];var o=a.getDistance(e,i);r+=o}return r}else{return 0}};a.getPolygonArea=function(a){if(!(a instanceof BMapGL.Polygon)&&!(a instanceof Array)){return 0}var n;if(a instanceof BMapGL.Polygon){n=a.getPath()}else{n=a}if(n[0].equals(n[n.length-1])){n.pop()}if(n.length<3){return 0}var r=0;var l=0;var e=0;var i=0;var o=0;var g=0;var h=0;var f=0;var s=0;var M=0;var v=0;var u=0;var P=0;var c=0;var I=0;var L=0;var m=0;var p=0;var B=0;var d=0;var y=0;var G=0;var S=0;var x=0;var R=0;var T=0;var b=0;var D=0;var q=0;var w=0;var A=0;var C=0;var E=0;var N=0;var O=t;var U=n.length;for(var W=0;W<U;W++){if(W==0){l=n[U-1].lng*Math.PI/180;e=n[U-1].lat*Math.PI/180;i=n[0].lng*Math.PI/180;o=n[0].lat*Math.PI/180;g=n[1].lng*Math.PI/180;h=n[1].lat*Math.PI/180}else if(W==U-1){l=n[U-2].lng*Math.PI/180;e=n[U-2].lat*Math.PI/180;i=n[U-1].lng*Math.PI/180;o=n[U-1].lat*Math.PI/180;g=n[0].lng*Math.PI/180;h=n[0].lat*Math.PI/180}else{l=n[W-1].lng*Math.PI/180;e=n[W-1].lat*Math.PI/180;i=n[W].lng*Math.PI/180;o=n[W].lat*Math.PI/180;g=n[W+1].lng*Math.PI/180;h=n[W+1].lat*Math.PI/180}f=Math.cos(o)*Math.cos(i);s=Math.cos(o)*Math.sin(i);M=Math.sin(o);v=Math.cos(e)*Math.cos(l);u=Math.cos(e)*Math.sin(l);P=Math.sin(e);c=Math.cos(h)*Math.cos(g);I=Math.cos(h)*Math.sin(g);L=Math.sin(h);m=(f*f+s*s+M*M)/(f*v+s*u+M*P);p=(f*f+s*s+M*M)/(f*c+s*I+M*L);B=m*v-f;d=m*u-s;y=m*P-M;G=p*c-f;S=p*I-s;x=p*L-M;q=(G*B+S*d+x*y)/(Math.sqrt(G*G+S*S+x*x)*Math.sqrt(B*B+d*d+y*y));if(q<-1)q=-1;if(q>1)q=1;q=Math.acos(q);R=S*y-x*d;T=0-(G*y-x*B);b=G*d-S*B;if(f!=0)D=R/f;else if(s!=0)D=T/s;else D=b/M;if(D>0){w+=q;E++}else{A+=q;C++}}var j,k;j=w+(2*Math.PI*C-A);k=2*Math.PI*E-w+A;if(w>A){if(j-(U-2)*Math.PI<1)N=j;else N=k}else{if(k-(U-2)*Math.PI<1)N=k;else N=j}r=(N-(U-2)*Math.PI)*O*O;return r};a.isPolylineIntersectArea=function(t,n){var r=function(t,a,n,r){var l=t.lng,e=t.lat;var i=a.lng,o=a.lat;var g=n.lng,h=n.lat;var f=r.lng,s=r.lat;if(!(Math.min(l,i)<=Math.max(g,f)&&Math.min(h,s)<=Math.max(e,o)&&Math.min(g,f)<=Math.max(l,i)&&Math.min(e,o)<=Math.max(h,s)))return false;var M,v,u,P;M=(g-l)*(o-e)-(i-l)*(h-e);v=(f-l)*(o-e)-(i-l)*(s-e);u=(l-g)*(s-h)-(f-g)*(e-h);P=(i-g)*(s-h)-(f-g)*(o-h);return M*v<=2e-10&&u*P<=2e-10};if(!(t instanceof BMapGL.Polyline&&n instanceof BMapGL.Polygon)){console.error("参数出错,传入值非折线和多边形");return false}t=t.getPath().map(function(t){return{lng:t.lng,lat:t.lat}});n=n.getPath().map(function(t){return{lng:t.lng,lat:t.lat}});if(t.length<1||n.length<=2){console.error("参数出错,传入值非折线和多边形");return false}var l=[],e=[];for(var i=0;i<t.length;i++){if(a.isPointInPolygon(t[i],n)){return true}}for(var o=1;o<t.length;o++){l.push([t[o-1],t[o]])}for(var g=1;g<n.length;g++){e.push([n[g-1],n[g]])}e.push([n[n.length-1],n[0]]);for(var h=0;h<l.length;h++){for(var f=0;f<e.length;f++){if(r(l[h][0],l[h][1],e[f][0],e[f][1]))return true}}return false}})();